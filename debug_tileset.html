<!DOCTYPE html>
<html>
<head>
    <title>Tileset Debug</title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://pixijs.download/v7.4.0/pixi.min.js"></script>
</head>
<body>
    <h1>Tileset Debug</h1>
    <div id="output"></div>
    
    <script type="module">
        import { TilesetManager } from './src/js/systems/tiles/TilesetManager.js';
        
        async function debugTileset() {
            const output = document.getElementById('output');
            
            try {
                const tilesetManager = new TilesetManager();
                await tilesetManager.load();
                
                // Check if row 13 exists
                const row13Exists = !!tilesetManager.textures.terrain[13];
                output.innerHTML += `<p>Row 13 exists: ${row13Exists}</p>`;
                
                if (row13Exists) {
                    const availableColumns = Object.keys(tilesetManager.textures.terrain[13]);
                    output.innerHTML += `<p>Available columns in row 13: ${availableColumns.join(', ')}</p>`;
                    
                    // Check specific stair textures
                    const greenStairTexture = tilesetManager.textures.terrain[13][2];
                    const darkStairTexture = tilesetManager.textures.terrain[13][13];
                    
                    output.innerHTML += `<p>Green stair texture (13,2): ${!!greenStairTexture}</p>`;
                    output.innerHTML += `<p>Dark stair texture (13,13): ${!!darkStairTexture}</p>`;
                }
                
                // Test world generation
                const { SharedWorldGenerator } = await import('./shared/systems/WorldGenerator.js');
                const worldGen = new SharedWorldGenerator(100, 100, 42);
                const worldData = worldGen.generateWorld();
                
                // Count stairs
                let greenStairs = 0;
                let darkStairs = 0;
                let undefinedBiomeStairs = 0;
                
                for (let y = 0; y < 100; y++) {
                    for (let x = 0; x < 100; x++) {
                        const stair = worldData.stairsData[y][x];
                        if (stair) {
                            if (stair.biome === 0) {
                                greenStairs++;
                            } else if (stair.biome === 1) {
                                darkStairs++;
                            } else {
                                undefinedBiomeStairs++;
                            }
                        }
                    }
                }
                
                output.innerHTML += `<p>Stairs summary:</p>`;
                output.innerHTML += `<p>- Green grass stairs: ${greenStairs}</p>`;
                output.innerHTML += `<p>- Dark grass stairs: ${darkStairs}</p>`;
                output.innerHTML += `<p>- Undefined biome stairs: ${undefinedBiomeStairs}</p>`;
                
            } catch (error) {
                output.innerHTML += `<p>Error: ${error.message}</p>`;
                console.error(error);
            }
        }
        
        debugTileset();
    </script>
</body>
</html>